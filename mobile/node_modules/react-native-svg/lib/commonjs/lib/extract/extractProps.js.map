{"version":3,"names":["clipRules","evenodd","nonzero","propsAndStyles","props","style","Array","isArray","Object","assign","getMarker","marker","undefined","matched","match","idPattern","extractProps","ref","id","opacity","onLayout","clipPath","clipRule","display","mask","markerStart","markerMid","markerEnd","extracted","inherited","extractResponder","extractFill","extractStroke","length","propList","matrix","extractTransform","extractOpacity","name","String","console","warn","extract","instance","stringifyPropsForFabric","keys","forEach","k","withoutXY","x","y"],"sources":["extractProps.ts"],"sourcesContent":["import extractFill from './extractFill';\nimport extractStroke from './extractStroke';\nimport extractTransform from './extractTransform';\nimport extractResponder from './extractResponder';\nimport extractOpacity from './extractOpacity';\nimport { idPattern } from '../util';\nimport {\n  ClipProps,\n  extractedProps,\n  FillProps,\n  NumberProp,\n  ResponderProps,\n  StrokeProps,\n  TransformProps,\n} from './types';\n\nconst clipRules: { evenodd: number; nonzero: number } = {\n  evenodd: 0,\n  nonzero: 1,\n};\n\nexport function propsAndStyles(props: Object & { style?: [] | {} }) {\n  const { style } = props;\n  return !style\n    ? props\n    : {\n        ...(Array.isArray(style) ? Object.assign({}, ...style) : style),\n        ...props,\n      };\n}\n\nfunction getMarker(marker?: string) {\n  if (!marker) {\n    return undefined;\n  }\n  const matched = marker.match(idPattern);\n  return matched ? matched[1] : undefined;\n}\n\nexport default function extractProps(\n  props: {\n    id?: string;\n    mask?: string;\n    marker?: string;\n    markerStart?: string;\n    markerMid?: string;\n    markerEnd?: string;\n    clipPath?: string;\n    display?: string;\n    opacity?: NumberProp;\n    onLayout?: () => void;\n  } & TransformProps &\n    ResponderProps &\n    StrokeProps &\n    FillProps &\n    ClipProps,\n  ref: Object,\n) {\n  const {\n    id,\n    opacity,\n    onLayout,\n    clipPath,\n    clipRule,\n    display,\n    mask,\n    marker,\n    markerStart = marker,\n    markerMid = marker,\n    markerEnd = marker,\n  } = props;\n  const extracted: extractedProps = {};\n\n  const inherited: string[] = [];\n  extractResponder(extracted, props, ref);\n  extractFill(extracted, props, inherited);\n  extractStroke(extracted, props, inherited);\n\n  if (inherited.length) {\n    extracted.propList = inherited;\n  }\n\n  const matrix = extractTransform(props);\n  if (matrix !== null) {\n    extracted.matrix = matrix;\n  }\n\n  if (opacity != null) {\n    extracted.opacity = extractOpacity(opacity);\n  }\n\n  if (display != null) {\n    extracted.display = display === 'none' ? 'none' : undefined;\n  }\n\n  if (onLayout) {\n    extracted.onLayout = onLayout;\n  }\n\n  if (markerStart) {\n    extracted.markerStart = getMarker(markerStart);\n  }\n  if (markerMid) {\n    extracted.markerMid = getMarker(markerMid);\n  }\n  if (markerEnd) {\n    extracted.markerEnd = getMarker(markerEnd);\n  }\n\n  if (id) {\n    extracted.name = String(id);\n  }\n\n  if (clipRule) {\n    extracted.clipRule = clipRules[clipRule] === 0 ? 0 : 1;\n  }\n  if (clipPath) {\n    const matched = clipPath.match(idPattern);\n    if (matched) {\n      extracted.clipPath = matched[1];\n    } else {\n      console.warn(\n        'Invalid `clipPath` prop, expected a clipPath like \"#id\", but got: \"' +\n          clipPath +\n          '\"',\n      );\n    }\n  }\n\n  if (mask) {\n    const matched = mask.match(idPattern);\n\n    if (matched) {\n      extracted.mask = matched[1];\n    } else {\n      console.warn(\n        'Invalid `mask` prop, expected a mask like \"#id\", but got: \"' +\n          mask +\n          '\"',\n      );\n    }\n  }\n\n  return extracted;\n}\n\nexport function extract(instance: Object, props: Object & { style?: [] | {} }) {\n  return extractProps(propsAndStyles(props), instance);\n}\n\nexport function stringifyPropsForFabric(props: {\n  [key: string]: NumberProp | undefined | null;\n}): { [key: string]: string } {\n  const extracted: { [key: string]: string } = {};\n  Object.keys(props).forEach((k) => {\n    if (props[k] !== undefined && props[k] !== null) {\n      extracted[k] = String(props[k]);\n    }\n  });\n\n  return extracted;\n}\n\nexport function withoutXY(\n  instance: Object,\n  props: Object & { style?: [] | {} },\n) {\n  return extractProps({ ...propsAndStyles(props), x: null, y: null }, instance);\n}\n"],"mappings":"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"}