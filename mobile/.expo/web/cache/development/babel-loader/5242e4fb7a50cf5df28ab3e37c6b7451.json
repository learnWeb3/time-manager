{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport * as React from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { Button, Text } from 'react-native-paper';\nimport { useDispatch } from 'react-redux';\nimport { validateEmail, validatePassword } from \"../../validators/index\";\nimport InputGroup from \"../InputGroup/index\";\nimport { setCurrentUser } from \"../../stores/reducers/currentUserReducer\";\nimport { login } from \"../../http/api\";\nimport { LocalStorage } from \"../../localstorage/index\";\nimport { env } from \"../../env/index\";\nimport { useAlert } from \"../../hooks/alert\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar LoginForm = function LoginForm() {\n  var _useAlert = useAlert(),\n    alert = _useAlert.alert,\n    setAlert = _useAlert.setAlert,\n    Snackbar = _useAlert.component;\n  var dispatch = useDispatch();\n  var _React$useState = React.useState({\n      email: {\n        isError: false,\n        value: \"\",\n        errors: []\n      },\n      password: {\n        isError: false,\n        value: \"\",\n        errors: []\n      }\n    }),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    formData = _React$useState2[0],\n    setFormData = _React$useState2[1];\n  React.useEffect(function () {\n    handleValidateFormData(formData);\n  }, [formData.email.value, formData.password.value]);\n  var handleSubmit = function () {\n    var _ref = _asyncToGenerator(function* () {\n      var message = \"\";\n      var severity = \"error\";\n      var data = {\n        email: formData.email.value,\n        password: formData.password.value\n      };\n      try {\n        var currentUser = yield login(data);\n        if (currentUser) {\n          yield LocalStorage.storeData(env.LOCAL_STORAGE_CURRENT_USER_KEY, currentUser);\n          dispatch(setCurrentUser(currentUser));\n          message = \"Loged in with success\";\n          severity = \"success\";\n        } else {\n          throw new Error('missing token field in response call');\n        }\n      } catch (error) {\n        message = \"An unexpected error has been encountered, please try again later or contact tour administrator\";\n      } finally {\n        setAlert({\n          toggled: true,\n          message: message,\n          severity: severity\n        });\n      }\n    });\n    return function handleSubmit() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var handleValidateFormData = function handleValidateFormData(formData) {\n    var _validateEmail = validateEmail(\"email\", formData.email.value),\n      emailIsValid = _validateEmail.isValid,\n      emailValidationsErrors = _validateEmail.errors;\n    var _validatePassword = validatePassword(\"password\", formData.password.value),\n      passwordIsValid = _validatePassword.isValid,\n      passwordValidationsErrors = _validatePassword.errors;\n    setFormData(_objectSpread(_objectSpread({}, formData), {}, {\n      email: _objectSpread(_objectSpread({}, formData.email), {}, {\n        isError: !emailIsValid,\n        errors: emailValidationsErrors\n      }),\n      password: _objectSpread(_objectSpread({}, formData.password), {}, {\n        isError: !passwordIsValid,\n        errors: passwordValidationsErrors\n      })\n    }));\n  };\n  var handleEmail = function handleEmail(email) {\n    var updatedFormData = _objectSpread(_objectSpread({}, formData), {}, {\n      email: _objectSpread(_objectSpread({}, formData.email), {}, {\n        value: email\n      })\n    });\n    setFormData(updatedFormData);\n  };\n  var handlePassword = function handlePassword(password) {\n    var updatedFormData = _objectSpread(_objectSpread({}, formData), {}, {\n      password: _objectSpread(_objectSpread({}, formData.password), {}, {\n        value: password\n      })\n    });\n    setFormData(updatedFormData);\n  };\n  var handleCloseAlert = function handleCloseAlert() {\n    setAlert({\n      toggled: false,\n      message: \"\",\n      severity: \"error\"\n    });\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsxs(View, {\n      style: {\n        flex: 2\n      },\n      children: [_jsx(InputGroup, {\n        isError: formData.email.isError,\n        errors: formData.email.errors,\n        value: formData.email.value,\n        handleInput: function handleInput(email) {\n          return handleEmail(email);\n        }\n      }), _jsx(InputGroup, {\n        isError: formData.password.isError,\n        errors: formData.password.errors,\n        value: formData.password.value,\n        label: \"************\",\n        handleInput: function handleInput(password) {\n          return handlePassword(password);\n        },\n        secureTextEntry: true\n      })]\n    }), _jsxs(View, {\n      style: {\n        flex: 2\n      },\n      children: [_jsx(Button, {\n        style: {\n          borderRadius: 4\n        },\n        textColor: \"white\",\n        buttonColor: \"#001f54\",\n        mode: \"contained\",\n        onPress: handleSubmit,\n        children: \"Connect\"\n      }), _jsx(Snackbar, {\n        onClose: handleCloseAlert,\n        toggled: alert.toggled,\n        message: alert.message,\n        severity: alert.severity\n      })]\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  header: {\n    marginBottom: 24\n  },\n  container: {\n    width: \"100%\",\n    padding: 24\n  }\n});\nexport default LoginForm;","map":{"version":3,"names":["React","Button","Text","useDispatch","validateEmail","validatePassword","InputGroup","setCurrentUser","login","LocalStorage","env","useAlert","LoginForm","alert","setAlert","Snackbar","component","dispatch","useState","email","isError","value","errors","password","formData","setFormData","useEffect","handleValidateFormData","handleSubmit","message","severity","data","currentUser","storeData","LOCAL_STORAGE_CURRENT_USER_KEY","Error","error","toggled","emailIsValid","isValid","emailValidationsErrors","passwordIsValid","passwordValidationsErrors","handleEmail","updatedFormData","handlePassword","handleCloseAlert","flex","borderRadius","styles","StyleSheet","create","header","marginBottom","container","width","padding"],"sources":["C:/Users/lahce/Desktop/epitech2023/pool/time-manager-/mobile/components/LoginForm/index.js"],"sourcesContent":["import * as React from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport { Button, Text } from 'react-native-paper';\r\nimport { useDispatch } from 'react-redux';\r\nimport { validateEmail, validatePassword } from '../../validators/index';\r\nimport InputGroup from '../InputGroup/index';\r\nimport { setCurrentUser } from '../../stores/reducers/currentUserReducer';\r\nimport { login } from '../../http/api';\r\nimport { LocalStorage } from '../../localstorage/index';\r\nimport { env } from '../../env/index';\r\nimport { useAlert } from '../../hooks/alert';\r\n\r\nconst LoginForm = () => {\r\n\r\n    const { alert, setAlert, component: Snackbar } = useAlert()\r\n    const dispatch = useDispatch()\r\n\r\n    const [formData, setFormData] = React.useState({\r\n        email: {\r\n            isError: false,\r\n            value: \"\",\r\n            errors: []\r\n        },\r\n        password: {\r\n            isError: false,\r\n            value: \"\",\r\n            errors: []\r\n        }\r\n    })\r\n\r\n    React.useEffect(() => {\r\n        handleValidateFormData(formData)\r\n    }, [formData.email.value, formData.password.value])\r\n\r\n    const handleSubmit = async () => {\r\n\r\n        let message = \"\";\r\n        let severity = \"error\"\r\n        const data = {\r\n            email: formData.email.value,\r\n            password: formData.password.value\r\n        }\r\n\r\n        try {\r\n            const currentUser = await login(data)\r\n            if (currentUser) {\r\n                await LocalStorage.storeData(\r\n                    env.LOCAL_STORAGE_CURRENT_USER_KEY,\r\n                    currentUser\r\n                )\r\n                dispatch(setCurrentUser(currentUser))\r\n                message = \"Loged in with success\";\r\n                severity = \"success\";\r\n            } else {\r\n                throw new Error('missing token field in response call')\r\n            }\r\n        } catch (error) {\r\n            message = \"An unexpected error has been encountered, please try again later or contact tour administrator\"\r\n        } finally {\r\n            setAlert({\r\n                toggled: true,\r\n                message,\r\n                severity\r\n            })\r\n        }\r\n    }\r\n\r\n    const handleValidateFormData = (formData) => {\r\n        const {\r\n            isValid: emailIsValid,\r\n            errors: emailValidationsErrors\r\n        } = validateEmail(\"email\", formData.email.value)\r\n        const {\r\n            isValid: passwordIsValid,\r\n            errors: passwordValidationsErrors\r\n        } = validatePassword(\"password\", formData.password.value)\r\n\r\n        setFormData({\r\n            ...formData,\r\n            email: {\r\n                ...formData.email,\r\n                isError: !emailIsValid,\r\n                errors: emailValidationsErrors\r\n            },\r\n            password: {\r\n                ...formData.password,\r\n                isError: !passwordIsValid,\r\n                errors: passwordValidationsErrors\r\n            }\r\n        })\r\n    }\r\n\r\n    const handleEmail = (email) => {\r\n        const updatedFormData = {\r\n            ...formData,\r\n            email: {\r\n                ...formData.email,\r\n                value: email\r\n            }\r\n        }\r\n        setFormData(updatedFormData)\r\n    }\r\n\r\n\r\n    const handlePassword = (password) => {\r\n        const updatedFormData = {\r\n            ...formData,\r\n            password: {\r\n                ...formData.password,\r\n                value: password\r\n            }\r\n        }\r\n        setFormData(updatedFormData)\r\n    }\r\n\r\n    const handleCloseAlert = () => {\r\n        setAlert({\r\n            toggled: false,\r\n            message: \"\",\r\n            severity: \"error\"\r\n        })\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <View style={{flex:2}}>\r\n                <InputGroup\r\n                    isError={formData.email.isError}\r\n                    errors={formData.email.errors}\r\n                    value={formData.email.value}\r\n                    handleInput={email => handleEmail(email)}/>\r\n                <InputGroup\r\n                    isError={formData.password.isError}\r\n                    errors={formData.password.errors}\r\n                    value={formData.password.value}\r\n                    label=\"************\"\r\n                    handleInput={password => handlePassword(password)}\r\n                    secureTextEntry={true}/>\r\n            </View>\r\n            <View style={{flex:2}}>\r\n                <Button style={{borderRadius:4}} textColor={\"white\"} buttonColor={\"#001f54\"}  mode=\"contained\" onPress={handleSubmit}>\r\n                    Connect\r\n                </Button>\r\n            <Snackbar onClose={handleCloseAlert} toggled={alert.toggled} message={alert.message} severity={alert.severity} />\r\n            </View>\r\n\r\n        </>\r\n    );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n    header: {\r\n        marginBottom: 24\r\n    },\r\n    container: {\r\n        width: \"100%\",\r\n        padding:24\r\n    },\r\n});\r\n\r\nexport default LoginForm;"],"mappings":"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"},"metadata":{},"sourceType":"module"}