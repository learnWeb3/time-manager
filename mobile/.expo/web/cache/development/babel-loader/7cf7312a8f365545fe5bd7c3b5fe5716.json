{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport axios from \"axios\";\nimport { Service } from 'axios-middleware';\nimport { env } from \"../env/index\";\nimport { setCurrentUser } from \"../stores/reducers/currentUserReducer\";\nimport { LocalStorage } from \"../localstorage/index\";\nvar httpApi = axios.create({\n  baseURL: env.API_BASE_URL,\n  timeout: 1000,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nvar service = new Service(httpApi);\nservice.register({\n  onResponse: function onResponse(response) {\n    if (response && response.status && response.status === 401) {\n      alert('test');\n      LocalStorage.removeData(env.LOCAL_STORAGE_CURRENT_USER_KEY).then(function () {\n        return setCurrentUser(null);\n      });\n    }\n    return response;\n  }\n});\nvar mergeAuthHeaders = function mergeAuthHeaders(axiosInstance, token) {\n  axiosInstance.defaults.headers.common['Authorization'] = \"Bearer \" + token;\n  return axiosInstance;\n};\nexport var login = function () {\n  var _ref = _asyncToGenerator(function* () {\n    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n      email: \"\",\n      password: \"\"\n    };\n    return yield httpApi.post('/sessions/login', data).then(function (response) {\n      return response.data;\n    });\n  });\n  return function login() {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var getUserStatus = function getUserStatus(token, userId) {\n  return mergeAuthHeaders(httpApi, token).get(\"/status/\" + userId).then(function (response) {\n    return response.data;\n  });\n};\nexport var createClock = function createClock(token, userId) {\n  var data = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {\n    clock: {\n      time: Math.round(Date.now() / 1000)\n    }\n  };\n  return mergeAuthHeaders(httpApi, token).post(\"/clocks/\" + userId, data).then(function (response) {\n    return response.data;\n  });\n};","map":{"version":3,"names":["axios","Service","env","setCurrentUser","LocalStorage","httpApi","create","baseURL","API_BASE_URL","timeout","headers","service","register","onResponse","response","status","alert","removeData","LOCAL_STORAGE_CURRENT_USER_KEY","then","mergeAuthHeaders","axiosInstance","token","defaults","common","login","data","email","password","post","getUserStatus","userId","get","createClock","clock","time","Math","round","Date","now"],"sources":["C:/Users/samue/OneDrive/Bureau/time-manager-/mobile/http/api.js"],"sourcesContent":["import axios from \"axios\";\r\nimport { Service } from 'axios-middleware';\r\nimport { env } from '../env/index';\r\nimport { setCurrentUser } from \"../stores/reducers/currentUserReducer\";\r\nimport { LocalStorage } from '../localstorage/index';\r\n\r\nconst httpApi = axios.create({\r\n    baseURL: env.API_BASE_URL,\r\n    timeout: 1000,\r\n    headers: { 'Content-Type': 'application/json' }\r\n});\r\n\r\n\r\nconst service = new Service(httpApi);\r\n\r\nservice.register({\r\n    onResponse(response) {\r\n        if (response && response.status && response.status === 401) {\r\n            alert('test')\r\n            LocalStorage.removeData(env.LOCAL_STORAGE_CURRENT_USER_KEY)\r\n                .then(() => setCurrentUser(null))\r\n        }\r\n        return response;\r\n    }\r\n});\r\n\r\n\r\nconst mergeAuthHeaders = (axiosInstance, token) => {\r\n    axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${token}`\r\n    return axiosInstance\r\n}\r\n\r\nexport const login = async (data = { email: \"\", password: \"\" }) => {\r\n    return await httpApi.post('/sessions/login', data).then((response) => response.data)\r\n}\r\n\r\nexport const getUserStatus = (token, userId) => mergeAuthHeaders(httpApi, token)\r\n    .get(`/status/${userId}`,)\r\n    .then((response) => response.data)\r\n\r\nexport const createClock = (token, userId, data = {\r\n    clock: {\r\n        time: Math.round(Date.now() / 1000)\r\n    }\r\n}) => mergeAuthHeaders(httpApi, token)\r\n    .post(`/clocks/${userId}`, data)\r\n    .then((response) => response.data)"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,OAAO,QAAQ,kBAAkB;AAC1C,SAASC,GAAG;AACZ,SAASC,cAAc;AACvB,SAASC,YAAY;AAErB,IAAMC,OAAO,GAAGL,KAAK,CAACM,MAAM,CAAC;EACzBC,OAAO,EAAEL,GAAG,CAACM,YAAY;EACzBC,OAAO,EAAE,IAAI;EACbC,OAAO,EAAE;IAAE,cAAc,EAAE;EAAmB;AAClD,CAAC,CAAC;AAGF,IAAMC,OAAO,GAAG,IAAIV,OAAO,CAACI,OAAO,CAAC;AAEpCM,OAAO,CAACC,QAAQ,CAAC;EACbC,UAAU,sBAACC,QAAQ,EAAE;IACjB,IAAIA,QAAQ,IAAIA,QAAQ,CAACC,MAAM,IAAID,QAAQ,CAACC,MAAM,KAAK,GAAG,EAAE;MACxDC,KAAK,CAAC,MAAM,CAAC;MACbZ,YAAY,CAACa,UAAU,CAACf,GAAG,CAACgB,8BAA8B,CAAC,CACtDC,IAAI,CAAC;QAAA,OAAMhB,cAAc,CAAC,IAAI,CAAC;MAAA,EAAC;IACzC;IACA,OAAOW,QAAQ;EACnB;AACJ,CAAC,CAAC;AAGF,IAAMM,gBAAgB,GAAG,SAAnBA,gBAAgB,CAAIC,aAAa,EAAEC,KAAK,EAAK;EAC/CD,aAAa,CAACE,QAAQ,CAACb,OAAO,CAACc,MAAM,CAAC,eAAe,CAAC,eAAaF,KAAO;EAC1E,OAAOD,aAAa;AACxB,CAAC;AAED,OAAO,IAAMI,KAAK;EAAA,6BAAG,aAA8C;IAAA,IAAvCC,IAAI,uEAAG;MAAEC,KAAK,EAAE,EAAE;MAAEC,QAAQ,EAAE;IAAG,CAAC;IAC1D,aAAavB,OAAO,CAACwB,IAAI,CAAC,iBAAiB,EAAEH,IAAI,CAAC,CAACP,IAAI,CAAC,UAACL,QAAQ;MAAA,OAAKA,QAAQ,CAACY,IAAI;IAAA,EAAC;EACxF,CAAC;EAAA,gBAFYD,KAAK;IAAA;EAAA;AAAA,GAEjB;AAED,OAAO,IAAMK,aAAa,GAAG,SAAhBA,aAAa,CAAIR,KAAK,EAAES,MAAM;EAAA,OAAKX,gBAAgB,CAACf,OAAO,EAAEiB,KAAK,CAAC,CAC3EU,GAAG,cAAYD,MAAM,CAAI,CACzBZ,IAAI,CAAC,UAACL,QAAQ;IAAA,OAAKA,QAAQ,CAACY,IAAI;EAAA,EAAC;AAAA;AAEtC,OAAO,IAAMO,WAAW,GAAG,SAAdA,WAAW,CAAIX,KAAK,EAAES,MAAM;EAAA,IAAEL,IAAI,uEAAG;IAC9CQ,KAAK,EAAE;MACHC,IAAI,EAAEC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACC,GAAG,EAAE,GAAG,IAAI;IACtC;EACJ,CAAC;EAAA,OAAKnB,gBAAgB,CAACf,OAAO,EAAEiB,KAAK,CAAC,CACjCO,IAAI,cAAYE,MAAM,EAAIL,IAAI,CAAC,CAC/BP,IAAI,CAAC,UAACL,QAAQ;IAAA,OAAKA,QAAQ,CAACY,IAAI;EAAA,EAAC;AAAA"},"metadata":{},"sourceType":"module"}